{"version":3,"sources":["webpack:///./src/views/Auth.vue","webpack:///./src/use/login-form.js","webpack:///./src/views/Auth.vue?eea7"],"names":["for","class","onSubmit","eError","type","id","name","eValue","eBlur","pError","pValue","pBlur","disabled","isSubmitting","isToManyAttempts","useLoginForm","store","useStore","router","useRouter","useForm","handleSubmit","submitCount","useField","yup","trim","required","email","value","errorMessage","handleBlur","min","computed","watch","val","setTimeout","values","dispatch","push","setup","route","query","message","error","render"],"mappings":"2IAEI,eAAwB,UAApB,mBAAe,G,EAGjB,eAAgC,SAAzBA,IAAI,SAAQ,SAAK,G,YAMxB,eAAoC,SAA7BA,IAAI,YAAW,UAAM,G,mBAMxBC,MAAM,e,gDAhBd,eAiBO,QAjBDA,MAAM,OAAQ,SAAM,8CAAU,EAAAC,UAAA,EAAAA,SAAA,qBAAQ,e,CAC1C,EAEA,eAIM,OAJAD,MAAK,yBAA6B,EAAAE,U,CACtC,E,eACA,eAA2E,SAApEC,KAAK,QAAQC,GAAG,QAAQC,KAAK,Q,qDAAiB,EAAAC,OAAM,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAf,EAAAD,UACxC,EAAAJ,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAGhC,eAIM,OAJAF,MAAK,yBAA6B,EAAAQ,U,CACtC,E,eACA,eAAoF,SAA7EL,KAAK,WAAWC,GAAG,WAAWC,KAAK,W,qDAAoB,EAAAI,OAAM,IAAG,OAAI,8BAAE,EAAAC,OAAA,EAAAA,MAAA,sB,mBAAf,EAAAD,UACjD,EAAAD,Q,iBAAb,eAAyC,yBAAjB,EAAAA,QAAM,I,0BAGhC,eAAqG,UAA7FR,MAAM,cAAcG,KAAK,SAAUQ,SAAU,EAAAC,cAAgB,EAAAC,kBAAkB,QAAK,gBAC5D,EAAAA,kB,iBAAhC,eAAmG,OAAnG,EAAkD,+C,mJCX/C,SAASC,IACd,IAAMC,EAAQC,iBACRC,EAASC,iBAFc,EAGqBC,iBAA3CC,EAHsB,EAGtBA,aAAcR,EAHQ,EAGRA,aAAcS,EAHN,EAGMA,YAHN,EAKsCC,eAC/D,QACAC,SAEGC,OACAC,SAAS,4BACTC,MAAM,uCANGpB,EALa,EAKpBqB,MAA6BzB,EALT,EAKL0B,aAAkCrB,EAL7B,EAKiBsB,WALjB,EAasCP,eAC/D,WACAC,SAEGC,OACAC,SAAS,6BACTK,IAAI,EAAG,yCANErB,EAba,EAapBkB,MAA6BnB,EAbT,EAaLoB,aAAkClB,EAb7B,EAaiBmB,WAStChB,EAAmBkB,gBAAS,kBAAMV,EAAYM,OAAS,KAE7DK,eAAMnB,GAAkB,SAAAoB,GAClBA,GACFC,YAAW,WACTb,EAAYM,MAAQ,IACnB,QAIP,IAAM1B,EAAWmB,EAAY,yDAAC,WAAOe,GAAP,0GAEpBpB,EAAMqB,SAAS,aAAcD,GAFT,OAG1BlB,EAAOoB,KAAK,KAHc,0GAAD,uDAS7B,MAAO,CACL/B,SAAQJ,SAAQK,QAChBE,SAAQD,SAAQE,QAChBT,WAAUW,eACVC,oBDvBS,OACbyB,MADa,WAEX,IAAMC,EAAQ,iBACRxB,EAAQ,iBASd,OAPIwB,EAAMC,MAAMC,SACd1B,EAAMqB,SAAS,aAAc,CAC3BT,MAAO,OAAAe,EAAA,MAAMH,EAAMC,MAAMC,SACzBtC,KAAM,YAIV,kBACKW,OEtCT,EAAO6B,OAASA,EAED","file":"js/chunk-2d0be70b.05e0b0d5.js","sourcesContent":["<template>\r\n  <form class=\"card\" @submit.prevent=\"onSubmit\">\r\n    <h1>Войти в систему</h1>\r\n\r\n    <div :class=\"['form-control', {invalid: eError}]\">\r\n      <label for=\"email\">Email</label>\r\n      <input type=\"email\" id=\"email\" name=\"email\" v-model=\"eValue\" @blur=\"eBlur\">\r\n      <small v-if=\"eError\">{{ eError }}</small>\r\n    </div>\r\n\r\n    <div :class=\"['form-control', {invalid: pError}]\">\r\n      <label for=\"password\">Пароль</label>\r\n      <input type=\"password\" id=\"password\" name=\"password\" v-model=\"pValue\" @blur=\"pBlur\">\r\n      <small v-if=\"pError\">{{ pError }}</small>\r\n    </div>\r\n\r\n    <button class=\"btn primary\" type=\"submit\" :disabled=\"isSubmitting || isToManyAttempts\">Войти</button>\r\n    <span class=\"text-danger\" v-if=\"isToManyAttempts\">Слишком много попыток, отдохните 5 секунд!</span>\r\n  </form>\r\n</template>\r\n\r\n<script>\r\nimport {error} from '@/utils/error'\r\nimport {useLoginForm} from '@/use/login-form'\r\nimport { useRoute } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\n\r\n\r\nexport default {\r\n  setup() {\r\n    const route = useRoute()\r\n    const store = useStore()\r\n\r\n    if (route.query.message) {\r\n      store.dispatch('setMessage', {\r\n        value: error(route.query.message),\r\n        type: 'warning'\r\n      })\r\n    }\r\n\r\n    return {\r\n      ...useLoginForm()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>","import {computed, watch} from 'vue'\r\nimport * as yup from 'yup'\r\nimport { useField, useForm } from 'vee-validate'\r\nimport {useStore} from 'vuex'\r\nimport {useRouter} from 'vue-router'\r\n\r\nexport function useLoginForm() {\r\n  const store = useStore()\r\n  const router = useRouter()\r\n  const {handleSubmit, isSubmitting, submitCount} = useForm()\r\n\r\n    const {value: eValue, errorMessage: eError, handleBlur: eBlur} = useField(\r\n      'email',\r\n      yup\r\n        .string()\r\n        .trim()\r\n        .required('Пожалуйста введите email')\r\n        .email('Необходимо ввечти корректный email')\r\n    )\r\n    const {value: pValue, errorMessage: pError, handleBlur: pBlur} = useField(\r\n      'password',\r\n      yup\r\n        .string()\r\n        .trim()\r\n        .required('Пожалуйста введите пароль')\r\n        .min(6, 'Необходимо ввести минимум 6 символов')\r\n    )\r\n\r\n    const isToManyAttempts = computed(() => submitCount.value >= 3)\r\n\r\n    watch(isToManyAttempts, val => {\r\n      if (val) {\r\n        setTimeout(() => {\r\n          submitCount.value = 0\r\n        }, 5000);\r\n      }\r\n    })\r\n\r\n    const onSubmit = handleSubmit(async (values) => {\r\n      try {\r\n        await store.dispatch('auth/login', values)\r\n        router.push('/')\r\n      } catch (e) {\r\n        \r\n      }\r\n    })\r\n\r\n    return {\r\n      eValue, eError, eBlur,\r\n      pValue, pError, pBlur,\r\n      onSubmit, isSubmitting,\r\n      isToManyAttempts\r\n    }\r\n}","import { render } from \"./Auth.vue?vue&type=template&id=5270fc1c\"\nimport script from \"./Auth.vue?vue&type=script&lang=js\"\nexport * from \"./Auth.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}